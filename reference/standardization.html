<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate Treatment Effect using Marginal Standardization (G-Computation) — standardization • impart</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate Treatment Effect using Marginal Standardization (G-Computation) — standardization"><meta name="description" content="Compute an estimate of a marginal treatment effect using marginal
standardization, also known as standardization or G-computation."><meta property="og:description" content="Compute an estimate of a marginal treatment effect using marginal
standardization, also known as standardization or G-computation."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">impart</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/impart.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Information Monitoring - Continuous Outcomes</h6></li>
    <li><a class="dropdown-item" href="../articles/design_continuous.html">Designing Information Monitored Trials for Continuous Outcomes</a></li>
    <li><a class="dropdown-item" href="../articles/monitoring_continuous.html">Monitoring Information for a Continuous Outcome</a></li>
    <li><a class="dropdown-item" href="../articles/analyses_continuous.html">Monitored Analyses for a Continuous Outcome</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Information Monitoring - Binary Outcomes</h6></li>
    <li><a class="dropdown-item" href="../articles/design_binary.html">Designing Information Monitored Trials for Binary Outcomes</a></li>
    <li><a class="dropdown-item" href="../articles/monitoring_binary.html">Monitoring Information for a Binary Outcome</a></li>
    <li><a class="dropdown-item" href="../articles/analyses_binary.html">Monitored Analyses for a Binary Outcome</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Information Monitoring - Time-to-Event Outcomes</h6></li>
    <li><a class="dropdown-item" href="../articles/design_time_to_event.html">Designing Information Monitored Trials for Time-to-Event Outcomes</a></li>
    <li><a class="dropdown-item" href="../articles/monitoring_time_to_event.html">Monitoring Information for a Time-to-Event Outcome</a></li>
    <li><a class="dropdown-item" href="../articles/analyses_time_to_event.html">Monitored Analyses for a Time-to-Event Outcome</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Additional Vignettes</h6></li>
    <li><a class="dropdown-item" href="../articles/analyses_group_sequential.html">Covariate Adjustment in Group Sequential Designs</a></li>
    <li><a class="dropdown-item" href="../articles/new_methods_in_impart.html">Implementing New Methods in `impart`</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Plans &amp; Specifications</h6></li>
    <li><a class="dropdown-item" href="../articles/plan_requirements.html">Software Requirements Specification</a></li>
    <li><a class="dropdown-item" href="../articles/plan_quality.html">Software Quality &amp; Management Plan</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jbetz-jhu/impart/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimate Treatment Effect using Marginal Standardization (G-Computation)</h1>
      <small class="dont-index">Source: <a href="https://github.com/jbetz-jhu/impart/blob/main/R/standardization.R" class="external-link"><code>R/standardization.R</code></a></small>
      <div class="d-none name"><code>standardization.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compute an estimate of a marginal treatment effect using marginal
standardization, also known as standardization or G-computation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">standardization</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  outcome_formula <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  outcome_formula_treatment <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  outcome_formula_control <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">family</span>,</span>
<span>  estimand <span class="op">=</span> <span class="st">"difference"</span>,</span>
<span>  treatment_column <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  se_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"influence"</span>, <span class="st">"score"</span>, <span class="st">"bootstrap"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  bootstrap_parameters <span class="op">=</span> <span class="fu">impart</span><span class="fu">::</span><span class="fu"><a href="boot_control.html">boot_control</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  bootstrap_ci_method <span class="op">=</span> <span class="st">"bca"</span>,</span>
<span>  variance_adjustment <span class="op">=</span> <span class="va">standardization_df_adjust_tsiatis_2008</span>,</span>
<span>  influence_function <span class="op">=</span> <span class="va">standardization_influence</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">standardization_fit</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  outcome_formula <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  outcome_formula_treatment <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  outcome_formula_control <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">family</span>,</span>
<span>  <span class="va">treatment_column</span>,</span>
<span>  <span class="va">predictors</span>,</span>
<span>  <span class="va">estimand</span>,</span>
<span>  <span class="va">verbose</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">standardization_influence</span><span class="op">(</span></span>
<span>  y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  a <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y_pred <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y1_pred <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y0_pred <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">estimand</span>,</span>
<span>  <span class="va">model_type</span>,</span>
<span>  <span class="va">has_intercept</span>,</span>
<span>  <span class="va">has_treatment_interaction</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">standardization_df_adjust_tsiatis_2008</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  outcome_formula <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  outcome_formula_treatment <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  outcome_formula_control <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">estimand</span>,</span>
<span>  <span class="va">treatment_column</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A <code>data.frame</code> containing the data to be analyzed.</p></dd>


<dt id="arg-outcome-formula">outcome_formula<a class="anchor" aria-label="anchor" href="#arg-outcome-formula"></a></dt>
<dd><p>A <code>formula</code> which includes treatment as a main
effect. To use treatment-stratified outcome models, leave this argument
<code>NULL</code>.</p></dd>


<dt id="arg-outcome-formula-treatment">outcome_formula_treatment<a class="anchor" aria-label="anchor" href="#arg-outcome-formula-treatment"></a></dt>
<dd><p>A <code>formula</code> for a regression model fit
to participants in the treatment arm. If using a single model with regression
parameters for treatment assignment, leave this argument <code>NULL</code>.</p></dd>


<dt id="arg-outcome-formula-control">outcome_formula_control<a class="anchor" aria-label="anchor" href="#arg-outcome-formula-control"></a></dt>
<dd><p>A <code>formula</code> for a regression model fit
to participants in the control arm. If using a single model with regression
parameters for treatment assignment, leave this argument <code>NULL</code>.</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>The <code>family</code> for the regression model(s) being fit.
See <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">?family</a></code>.</p></dd>


<dt id="arg-estimand">estimand<a class="anchor" aria-label="anchor" href="#arg-estimand"></a></dt>
<dd><p>A <code>character</code> scalar, indicating the estimand to be
returned: <code>"difference"</code> for a difference in means (or risk difference);
<code>"ratio"</code> for a ratio of means (or relative risk), or <code>"oddsratio"</code>
for an odds ratio.</p></dd>


<dt id="arg-treatment-column">treatment_column<a class="anchor" aria-label="anchor" href="#arg-treatment-column"></a></dt>
<dd><p>A <code>character</code> scalar indicating the column that
contains the binary indicator of treatment assignment.</p></dd>


<dt id="arg-se-method">se_method<a class="anchor" aria-label="anchor" href="#arg-se-method"></a></dt>
<dd><p>A <code>character</code> scalar, indicating the method for
computing standard errors: <code>"none"</code> for no standard errors;</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Confidence level for computing interval estimates. This is only
used when <code>se_method != "none"</code>.</p></dd>


<dt id="arg-bootstrap-parameters">bootstrap_parameters<a class="anchor" aria-label="anchor" href="#arg-bootstrap-parameters"></a></dt>
<dd><p>A <code>list</code> of parameters to be passed to
<code><a href="https://rdrr.io/pkg/boot/man/boot.html" class="external-link">boot::boot()</a></code> when computing bootstrap standard errors and confidence
intervals. See <code>?boot::boot()</code>. This is only used when
<code>se_method == "bootstrap"</code>.</p></dd>


<dt id="arg-bootstrap-ci-method">bootstrap_ci_method<a class="anchor" aria-label="anchor" href="#arg-bootstrap-ci-method"></a></dt>
<dd><p>A <code>character</code> scalar, specifying the type of
interval estimates to compute. See <code>?boot::boot()</code>. This is only used
when <code>se_method == "bootstrap"</code>.</p></dd>


<dt id="arg-variance-adjustment">variance_adjustment<a class="anchor" aria-label="anchor" href="#arg-variance-adjustment"></a></dt>
<dd><p>A <code>function</code> for computing a finite-sample
variance adjustment for degrees of freedom in model fitting.</p></dd>


<dt id="arg-influence-function">influence_function<a class="anchor" aria-label="anchor" href="#arg-influence-function"></a></dt>
<dd><p>A <code>function</code> for computing the influence
function of each observation, which can be used for variance and covariance
calculations.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A <code>logical</code> scalar: if <code>FALSE</code>, only results are
returned; if <code>TRUE</code>, additional objects used to construct the estimate
are also returned.</p></dd>


<dt id="arg-predictors">predictors<a class="anchor" aria-label="anchor" href="#arg-predictors"></a></dt>
<dd><p>A <code>character</code> vector containing the names of
covariates: used to check for missing values to be imputed.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>A <code>numeric</code> vector containing the outcome values.</p></dd>


<dt id="arg-a">a<a class="anchor" aria-label="anchor" href="#arg-a"></a></dt>
<dd><p>A <code>numeric</code> vector containing the binary treatment assignment
indicator.</p></dd>


<dt id="arg-y-pred">y_pred<a class="anchor" aria-label="anchor" href="#arg-y-pred"></a></dt>
<dd><p>A <code>numeric</code> vector containing the model-predicted value
of the outcome under the observed treatment assignment.</p></dd>


<dt id="arg-y-pred">y1_pred<a class="anchor" aria-label="anchor" href="#arg-y-pred"></a></dt>
<dd><p>A <code>numeric</code> vector containing the model-predicted value
of the outcome under assignment to treatment.</p></dd>


<dt id="arg-y-pred">y0_pred<a class="anchor" aria-label="anchor" href="#arg-y-pred"></a></dt>
<dd><p>A <code>numeric</code> vector containing the model-predicted value
of the outcome under assignment to control.</p></dd>


<dt id="arg-model-type">model_type<a class="anchor" aria-label="anchor" href="#arg-model-type"></a></dt>
<dd><p>A <code>character</code> scalar: either "stratified" or "single"
model, used to indicate the analysis approach</p></dd>


<dt id="arg-has-intercept">has_intercept<a class="anchor" aria-label="anchor" href="#arg-has-intercept"></a></dt>
<dd><p>A <code>logical</code> scalar, indicating whether an intercept
term is included in the model.</p></dd>


<dt id="arg-has-treatment-interaction">has_treatment_interaction<a class="anchor" aria-label="anchor" href="#arg-has-treatment-interaction"></a></dt>
<dd><p>A <code>logical</code> scalar, indicating whether
treatment-by-covariate interactions are included in the model.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Depending on the options specified, a <code>numeric</code> scalar
containing the estimate, a <code>data.frame</code> containing estimates, standard
errors, and confidence intervals, or a <code>list</code> additionally containing
objects used in constructing the estimates.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Marginal standardization can be viewed as a generalization of the ANCOVA
estimate: the estimated treatment effect will coincide with ANCOVA when a
single outcome model with an identity link is fit using a functional form
where treatment assignment only appears as a main effect (i.e. no
treatment-by-covariate interactions).</p>
<p>Outcome regressions can include a single generalized linear model, or two
treatment-stratified generalized linear models. Variance estimates can be
obtained through the nonparametric bootstrap. Variance estimation using the
influence or score function can also be obtained for certain estimands and
outcome models.</p>
<p><code>standardization</code> should be used: this checks inputs, and calls
<code>standardization_fit</code>: the latter has been streamlined to speed up
the nonparametric bootstrap.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">impart</span><span class="fu">::</span><span class="fu">standardization</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">example_1</span>,</span></span>
<span class="r-in"><span>  outcome_formula <span class="op">=</span> <span class="va">y_4</span> <span class="op">~</span> <span class="va">x_1</span> <span class="op">+</span> <span class="va">x_2</span> <span class="op">+</span> <span class="va">x_3</span> <span class="op">+</span> <span class="va">x_4</span> <span class="op">+</span> <span class="va">tx</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  estimand <span class="op">=</span> <span class="st">"difference"</span>,</span></span>
<span class="r-in"><span>  treatment_column <span class="op">=</span> <span class="st">"tx"</span>,</span></span>
<span class="r-in"><span>  se_method <span class="op">=</span> <span class="st">"influence"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   estimate se_influence lcl_influence_0.95 ucl_influence_0.95   estimand</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 3.302204     1.147582           1.052984           5.551424 difference</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">impart</span><span class="fu">::</span><span class="fu">standardization</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">example_1</span>,</span></span>
<span class="r-in"><span>  outcome_formula <span class="op">=</span> <span class="va">y_4</span> <span class="op">~</span> <span class="va">x_1</span> <span class="op">+</span> <span class="va">x_2</span> <span class="op">+</span> <span class="va">x_3</span> <span class="op">+</span> <span class="va">x_4</span> <span class="op">+</span> <span class="va">tx</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  estimand <span class="op">=</span> <span class="st">"difference"</span>,</span></span>
<span class="r-in"><span>  treatment_column <span class="op">=</span> <span class="st">"tx"</span>,</span></span>
<span class="r-in"><span>  se_method <span class="op">=</span> <span class="st">"score"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   estimate se_score lcl_score_0.95 ucl_score_0.95   estimand</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 3.302204 1.152525       1.043296       5.561112 difference</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://publichealth.jhu.edu/faculty/2679/joshua-betz" class="external-link">Josh Betz</a>, <a href="https://kellyvanlancker.com/" class="external-link">Kelly Van Lancker</a>, <a href="https://mrosenblumbiostat.wordpress.com/" class="external-link">Michael Rosenblum</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

