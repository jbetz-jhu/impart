<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Covariate Adjustment in Group Sequential Designs • impart</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Covariate Adjustment in Group Sequential Designs">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">impart</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/impart.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Information Monitoring - Continuous Outcomes</h6></li>
    <li><a class="dropdown-item" href="../articles/design_continuous.html">Designing Information Monitored Trials for Continuous Outcomes</a></li>
    <li><a class="dropdown-item" href="../articles/monitoring_continuous.html">Monitoring Information for a Continuous Outcome</a></li>
    <li><a class="dropdown-item" href="../articles/analyses_continuous.html">Monitored Analyses for a Continuous Outcome</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Information Monitoring - Binary Outcomes</h6></li>
    <li><a class="dropdown-item" href="../articles/design_binary.html">Designing Information Monitored Trials for Binary Outcomes</a></li>
    <li><a class="dropdown-item" href="../articles/monitoring_binary.html">Monitoring Information for a Binary Outcome</a></li>
    <li><a class="dropdown-item" href="../articles/analyses_binary.html">Monitored Analyses for a Binary Outcome</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Information Monitoring - Time-to-Event Outcomes</h6></li>
    <li><a class="dropdown-item" href="../articles/design_time_to_event.html">Designing Information Monitored Trials for Time-to-Event Outcomes</a></li>
    <li><a class="dropdown-item" href="../articles/monitoring_time_to_event.html">Monitoring Information for a Time-to-Event Outcome</a></li>
    <li><a class="dropdown-item" href="../articles/analyses_time_to_event.html">Monitored Analyses for a Time-to-Event Outcome</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Additional Vignettes</h6></li>
    <li><a class="dropdown-item" href="../articles/analyses_group_sequential.html">Covariate Adjustment in Group Sequential Designs</a></li>
    <li><a class="dropdown-item" href="../articles/new_methods_in_impart.html">Implementing New Methods in `impart`</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jbetz-jhu/impart/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Covariate Adjustment in Group Sequential Designs</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jbetz-jhu/impart/blob/main/vignettes/analyses_group_sequential.Rmd" class="external-link"><code>vignettes/analyses_group_sequential.Rmd</code></a></small>
      <div class="d-none name"><code>analyses_group_sequential.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="planning-the-study">Planning The Study<a class="anchor" aria-label="anchor" href="#planning-the-study"></a>
</h2>
<p>Planning an information-monitored study is similar in many respects
to planning a study with a fixed sample size. Investigators must decide
on <a href="https://covariateadjustment.github.io/estimands.html" class="external-link">the
target of statistical inference, also known as an estimand</a>: for a
continuous outcome, the difference in means or a ratio of means may be
of interest. Once the estimand is chosen, decisions must be made about
what constitutes a meaningful effect size on the scale of the estimand
(e.g. a difference in means of 5 or a ratio of means of 1.25). Finally,
the characteristics of the testing procedure must be specified,
including the desired Type I Error Rate, statistical power, and
direction of alternatives of interest:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Universal Study Design Parameters</span></span>
<span><span class="va">minimum_difference</span> <span class="op">&lt;-</span> <span class="fl">5</span> <span class="co"># Effect Size: Difference in Means of 5 or greater</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span> <span class="co"># Type I Error Rate</span></span>
<span><span class="va">power</span> <span class="op">&lt;-</span> <span class="fl">0.9</span> <span class="co"># Statistical Power</span></span>
<span><span class="va">test_sides</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="co"># Direction of Alternatives</span></span></code></pre></div>
<div class="section level3">
<h3 id="sample-size-calculations-fixed-sample-size">Sample Size Calculations: Fixed Sample Size<a class="anchor" aria-label="anchor" href="#sample-size-calculations-fixed-sample-size"></a>
</h3>
<p>If the standard deviation in the population is assumed to be 10, the
fixed sample size required to identify a difference in means of 5 with
90% power and 5% Familywise Type I Error with a 2-sided test is:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute Fixed Sample Size Requirement</span></span>
<span><span class="va">fixed_n_sd_10</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">pwr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pwr/man/pwr.t.test.html" class="external-link">pwr.t.test</a></span><span class="op">(</span></span>
<span>    d <span class="op">=</span> <span class="va">minimum_difference</span><span class="op">/</span><span class="fl">10</span>,</span>
<span>    sig.level <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>    power <span class="op">=</span> <span class="va">power</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">fixed_n_sd_10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      Two-sample t test power calculation </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;               n = 85.03128</span></span>
<span><span class="co">#&gt;               d = 0.5</span></span>
<span><span class="co">#&gt;       sig.level = 0.05</span></span>
<span><span class="co">#&gt;           power = 0.9</span></span>
<span><span class="co">#&gt;     alternative = two.sided</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; NOTE: n is number in *each* group</span></span></code></pre></div>
<p>Note that this is the number of observed outcomes: this sample size
must be increased to account for missing data:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pr_missing</span> <span class="op">&lt;-</span> <span class="fl">0.2</span> <span class="co"># 20% missing outcomes</span></span>
<span></span>
<span><span class="va">fixed_n_total</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">fixed_n_sd_10</span><span class="op">$</span><span class="va">n</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">pr_missing</span><span class="op">)</span></span></code></pre></div>
<p>Accounting for 20% missing outcomes, a sample size of 215 will be
needed to obtain 172 primary outcomes.</p>
</div>
<div class="section level3">
<h3 id="adjusting-information-for-multiple-analyses">Adjusting Information for Multiple Analyses<a class="anchor" aria-label="anchor" href="#adjusting-information-for-multiple-analyses"></a>
</h3>
<p>Rather than waiting until all 215 participants complete the study,
interim analyses may be useful to evaluate the efficacy of the
intervention, and perhaps whether a trial should be stopped for futility
using a group sequential design:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Group Sequential Design Parameters</span></span>
<span><span class="va">information_rates</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.50</span>, <span class="fl">0.75</span>, <span class="fl">1.00</span><span class="op">)</span> <span class="co"># Analyses at 50%, 75%, and 100% of the Total Sample Size</span></span>
<span><span class="va">type_of_design</span> <span class="op">&lt;-</span> <span class="st">"asOF"</span> <span class="co"># O'Brien-Fleming Alpha Spending</span></span>
<span><span class="va">type_beta_spending</span> <span class="op">&lt;-</span> <span class="st">"bsOF"</span> <span class="co"># O'Brien-Fleming Beta Spending</span></span></code></pre></div>
<p>The <code>getDesignGroupSequential</code> function in the
<code>rpact</code> library can be used to specify the appropriate study
design. For example, a two-sided test comparing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><msub><mi>μ</mi><mi>T</mi></msub><mo>−</mo><msub><mi>μ</mi><mi>C</mi></msub><mo>=</mo><msub><mi>δ</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">H_{0}: \mu_{T} - \mu_{C} = \delta_{0}</annotation></semantics></math>
vs. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>A</mi></msub><mo>:</mo><msub><mi>μ</mi><mi>T</mi></msub><mo>−</mo><msub><mi>μ</mi><mi>C</mi></msub><mo>≠</mo><msub><mi>δ</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">H_{A}: \mu_{T} - \mu_{C} \neq \delta_{0}</annotation></semantics></math></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set up group sequential testing procedure</span></span>
<span><span class="va">trial_design</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">rpact</span><span class="fu">::</span><span class="fu"><a href="https://rpact-com.github.io/rpact/reference/getDesignGroupSequential.html" class="external-link">getDesignGroupSequential</a></span><span class="op">(</span></span>
<span>    alpha <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>    beta <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">power</span>,</span>
<span>    sided <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    informationRates <span class="op">=</span> <span class="va">information_rates</span>,</span>
<span>    typeOfDesign <span class="op">=</span> <span class="va">type_of_design</span>,</span>
<span>    typeBetaSpending <span class="op">=</span> <span class="va">type_beta_spending</span>,</span>
<span>    bindingFutility <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>When doing sequential analyses in an group sequential design, the
final sample size must be adjusted. The sample size inflation factor can
be obtained and used to obtain the final sample size for a group
sequential design:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Obtain inflation factor to preserve Type I Error: adjust fixed sample size</span></span>
<span><span class="va">inflation_factor</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">rpact</span><span class="fu">::</span><span class="fu"><a href="https://rpact-com.github.io/rpact/reference/getDesignCharacteristics.html" class="external-link">getDesignCharacteristics</a></span><span class="op">(</span><span class="va">trial_design</span><span class="op">)</span><span class="op">$</span><span class="va">inflationFactor</span></span>
<span></span>
<span><span class="va">group_sequential_n_total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">fixed_n_total</span><span class="op">*</span><span class="va">inflation_factor</span><span class="op">)</span></span>
<span><span class="va">group_sequential_n_total</span></span>
<span><span class="co">#&gt; [1] 234</span></span>
<span></span>
<span><span class="co"># Determine sample sizes when analyses will take place</span></span>
<span><span class="va">group_sequential_n_analyses</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">information_rates</span><span class="op">*</span><span class="va">group_sequential_n_total</span><span class="op">)</span></span>
<span></span>
<span><span class="va">group_sequential_n_analyses</span></span>
<span><span class="co">#&gt; [1] 117 176 234</span></span></code></pre></div>
<p>Interim analyses require a 8% increase in the overall sample size,
but allow for two pre-planned analyses for efficacy. Enrollment will
continue until 234 participants are recruited: the first interim
analysis will occur when 117 participants have their primary outcome
measured: if the trial is not stopped, the second interim analysis will
occur when 176 participants have been assessed for the primary outcome.
If the trial has not stopped after the second interim analysis, the
final analysis will occur when all 234 participants reach the end of the
study.</p>
</div>
<div class="section level3">
<h3 id="performing-interim-analysis-1">Performing Interim Analysis 1<a class="anchor" aria-label="anchor" href="#performing-interim-analysis-1"></a>
</h3>
<p>Once 117 participants have had their final outcomes obtained, the
first interim analysis can proceed:</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://kellyvanlancker.com/" class="external-link">Kelly Van Lancker</a>, <a href="https://publichealth.jhu.edu/faculty/2679/joshua-betz" class="external-link">Josh Betz</a>, <a href="https://mrosenblumbiostat.wordpress.com/" class="external-link">Michael Rosenblum</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
